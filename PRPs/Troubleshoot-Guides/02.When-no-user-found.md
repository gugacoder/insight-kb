# When no user found

## **ISSUE**

User receives authentication error during development setup after deleting user data from database. The system fails because refresh tokens in browser/localStorage are still trying to authenticate with a deleted user.

**Context:**
- Development mode (not using Docker)
- Running: `npm run frontend:dev` and `npm run backend:dev`
- Local MongoDB instance
- Database changed to `InsightKB`
- User was deleted but JWT token still references deleted ObjectId

**Error symptoms:**
- JWT token in browser points to non-existent ObjectId
- Authentication fails on app startup
- Orphaned refresh tokens cause login issues

## **RESOLUTION**

**Step 1: Identify Database Parameters**

Check your `.env` file to find the MONGO_URI and extract the host and database name.
Example: `MONGO_URI=mongodb://mongo:27017/InsightKB`
- host: `mongo`
- port: `27017`
- database-name: `InsightKB`

**Step 2: Connect to MongoDB**

```bash
mongosh mongodb://{host}:{port}
```

**Step 3: Clean Corrupted Sessions**

Execute these three commands in sequence:

```bash
use {database-name}  # replace with your actual database name

db.sessions.deleteMany({})

# Se existir uma collection de tokens, limpar também
# db.refreshtokens.deleteMany({})

exit
```

**Step 4: Notify the User**

Clearly inform the user to:
- Clear browser data by opening DevTools (F12), going to Application → Storage → Clear Storage → "Clear site data", or using Ctrl+Shift+Delete to clear site data.
- Close the browser completely, restart the backend with `npm run backend:dev`, open browser in private/incognito tab, and register a new user to test the fix.